# 🚇 서울 지하철 최적 경로 탐색기 (1~5호선)
2025학년도 자료구조 및 알고리즘 팀 프로젝트로, 서울 지하철 1~5호선의 최적 경로를 찾는 시스템을 구현했습니다. 사용자는 최단 시간 또는 최소 환승 두 가지 기준 중 하나를 선택하여 경로를 탐색할 수 있습니다.


## 👥 팀원 및 역할 분담
· 곽용진 : Floyd-Warshall 알고리즘, Y자 환승 구간 최적화, Folium을 이용한 맵 시각화
· 김이영 : 데이터 수집 및 전처리, Dijkstra 알고리즘, 최소 환승 Dijkstra 알고리즘


## ✨ 주요 기능
· 최단 시간 경로 탐색: Dijkstra 알고리즘을 사용하여 출발지부터 도착지까지 가장 빠르게 도착할 수 있는 경로를 제공합니다.
· 최소 환승 경로 탐색: 환승을 최소화하는 경로를 우선적으로 탐색하는 변형된 Dijkstra 알고리즘을 구현하여, 환승을 꺼리는 사용자에게 최적의 대안을 제공합니다
· Y자 분기 환승 최적화: 금천구청, 병점, 구로, 강동역과 같이 동일 역, 동일 호선 내에서 반대 방향으로 갈아타야 하는 특수한 'Y자 환승' 구간을 탐지하고 경로를 최적화하는 독자적인 로직(y_clear)을 구현했습니다.
· 이중 모드 지원 **(Dijkstra & Floyd-Warshall)**: 단일 경로 탐색에는 Dijkstra를, 반복적인 다중 경로 탐색 시에는 사전 계산된 Floyd-Warshall 결과를 활용하여 O(1) 수준의 빠른 응답이 가능하도록 설계했습니다.
· 경로 시각화: **folium** 라이브러리를 사용해 탐색된 경로를 지도 위에 시각적으로 표시합니다. 각 호선은 고유한 색상으로 구분되며, 환승 지점과 이동 경로를 직관적으로 파악할 수 있습니다.


## 📂 데이터 전처리
총 12개의 공공 데이터를 수집하여 시스템에 필요한 형태로 가공했습니다.

### 주요 데이터 출처
· 서울교통공사: 노선별 지하철역 정보, 역사 좌표(위/경도), 환승 정보, 표정속도 정보
· 국가철도공단: 1~5호선 역간 거리 정보

### 전처리 과정
1. 각 역의 좌표, 호선, 연결 정보를 통합하고 '역명_호선' 형식의 고유 노드를 생성했습니다.
2. 역간 거리와 호선별 표정속도를 이용해 이동 소요 시간(가중치)을 계산했습니다.
3. 환승 정보를 정제하여 **(역명,호선):소요시간** 형식으로 통일했습니다.
4. 누락된 역 정보를 보완하고, 불필요한 중복 데이터를 제거하여 최종적으로 **input2.csv** 파일을 생성했습니다.


## ⚙️ 시스템 흐름
```text
graph TD
    A[START] --> B{데이터 로드};
    B --> C{데이터 전처리};
    C --> D{그래프 생성};
    D --> E{사용자 입력: 출발/도착역};
    E --> F{경로 탐색 알고리즘 선택};
    F --> G[1. 최단 시간 (Dijkstra)];
    F --> H[2. 최소 환승 (Modified Dijkstra)];
    F --> I[3. 모든 경로 사전계산 (Floyd-Warshall)];
    subgraph "탐색 결과"
        G --> J{경로 복원};
        H --> J;
        I --> J;
    end
    J --> K{Y자 환승 최적화};
    K --> L[경로 출력 (텍스트)];
    K --> M[경로 시각화 (Folium)];
    L --> Z[END];
    M --> Z;
```

## 🚀 실행 방법
1. 필요한 라이브러리를 설치합니다.
```bash
pip install pandas folium numpy matplotlib
```
2. 지하철_최단경로.ipynb 파일을 시행하여 출발역과 도착역 정보를 입력합니다.
```python
# 사용자로부터 입력받는 부분
start_node = get_valid_node("출발 역과 호선을 입력해주세요 (예: 서울역 1): ", nodes)
end_node = get_valid_node("도착 역과 호선을 입력해주세요 (예: 강남역 2): ", nodes)
```


## 📊 결과 예시
입력: 출발: **서울역 1**, 도착: **강남역 2**

출력(텍스트)
```text
-----------------최단경로-----------------
총 소요 시간: 25분
-------------------출발-------------------
0초
서울역(1호선)
[1호선에서 4호선으로 환승] : 2분 12초
------------------------------------------
13분
서울역(4호선) → 숙대입구역(4호선) → ... → 사당역(4호선)
[4호선에서 2호선으로 환승] : 1분
------------------------------------------
8분 48초
사당역(2호선) → 방배역(2호선) → ... → 강남역(2호선)
-------------------도착-------------------
환승 횟수 : 2

-----------------최소환승-----------------
최소 환승 경로 소요 시간: 40분 24초
-------------------출발-------------------
2분
서울역(1호선) → 시청역(1호선)
[1호선에서 2호선으로 환승] : 1분 24초
------------------------------------------
37분
시청역(2호선) → 을지로입구역(2호선) → ... → 강남역(2호선)
-------------------도착-------------------
환승 횟수 : 1
```

출력 (지도 시각화)
최단 경로 탐색 결과가 Folium 지도로 시각화되어, 각기 다른 색상으로 표시된 호선을 따라 경로를 쉽게 확인할 수 있습니다.
![Uploading image.png…](결과)

## 💡 알고리즘 성능 비교
| 알고리즘 | 실행 시간 (단일 쿼리) | 비고 |
| --- | --- | --- |
| **Dijkstra** | 약 0.001s | 단일 경로 실시간 탐색에 유리 |
| **Floyd-Warshall (최초 계산)** | 약 4.0s ~ 8.5s | 모든 경로를 사전 계산 |
| **Floyd-Warshall (결과 재사용)** | 약 0.0002s | 사전 계산된 파일 로드 후 O(1) 탐색 |
· Dijkstra는 단일 쿼리에 대해 매우 빠르고 메모리 효율적입니다.
· Floyd-Warshall은 초기 계산 비용이 크지만, 결과를 저장하고 재사용하면 반복적인 쿼리에서 훨씬 빠른 성능을 보입니다.

## ⚙️ Y자 분기 환승 최적화
![가상역표현](https://github.com/user-attachments/assets/37467235-bf32-465b-b811-0139324a6d44)
· Y자 분기 환승을 위해 새로운 가상의 역을 추가하였습니다.
· 이후 경로 복원을 통해 가상의 역에 사용된 시간을 활용하는 경우와 그렇지 않는 경우를 나누어 처리하였습니다.
